{% extends 'tour/base_no_header.html' %}

{% load crispy_forms_tags %}

{% block main_area %}

<div class="fh5co-hero">
	<div class="fh5co-overlay"></div>
	<div class="fh5co-cover" data-stellar-background-ratio="0.5" style="background-image: url(images/cover_bg_3.jpg);">
		<div class="desc">
			<div class="container">
				<div class="row">
					<!--이미지-->
					<div class="col-sm-7 col-md-7 animate-box" style="overflow: hidden; margin-top:-150px;" >
						<!--헤드 이미지 있을 때만 출력-->
                        {% if tour.head_image %}
                            <!--헤드 이미지-->
							<img class="img-responsive" style="overflow: hidden;" src="{{ packagetour.head_image.url }}" alt="travel">
                        {% else %}
                            <!--기본 이미지-->
							<img class="img-responsive" style="overflow: hidden;" src="{{ packagetour.image.url }}" alt="travel">
                        {% endif %}
					</div>

					<div class="col-sm-5 col-md-5">
						<div class="tabulation animate-box">
							<!-- Nav tabs -->
							<ul class="nav nav-tabs" role="tablist">
								<li role="presentation" class="active">
									<a href="#flights" aria-controls="flights" role="tab" data-toggle="tab">여행 정보</a>
								</li>
							</ul>

							<!-- Tab panes -->
							<div class="tab-content">
								<div role="tabpanel" class="tab-pane active" id="flights">
									<div class="row">
										<!--여행 제목-->
										<div class="col-12 mt">
											<h3 style="color:black;">{{ packagetour.name }}</h3>
										</div>
										<!--여행 요약-->
										<div class="col-12 mt">
											<p style="color:black;">
												{{ packagetour.head_text }}
											</p>
										</div>
										<!--여행 일자-->
										<div class="col-12 mt">
											<label>여행 일자 : </label>
											<p style="color:black;">
												{{ packagetour.start_day | date:"20y년 m월 d일 h시 m분" }} 부터<br>
												{{ packagetour.end_day | date:"20y년 m월 d일 h시 m분"  }} 까지
											</p>
										</div>
										<!--가격-->
										<div class="col-12 mt">
											<label>가격 : </label>
											<span style="color:black;">{{ packagetour.price }}<small>원</small></span>
										</div>
										<!--구매 버튼-->
										<div class="col-xs-12">
											<input type="submit" class="btn btn-primary btn-block" value="구매하기">
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>
</div>


    <div id="fh5co-tours" class="fh5co-section-gray">
			<div class="container">
				<div class="row">
					<div class="col-md-8 col-md-offset-2 text-center heading-section animate-box">
						<!--여행 제목-->
						<h3>{{ packagetour.name }}</h3>
						<!--여행 소개-->
						<p>{{ packagetour.head_text }}</p>
					</div>
				</div>
				<div class="row row-bottom-padded-md">
					<div class="col-md-12 animate-box">
						<h2 class="heading-title">
							여행 상세 정보

							<!--수정 버튼-->
							{% if user.is_authenticated and user == packagetour.author %}
								<button type="button" class="btn btn-primary btn-outline btn-lg" onclick="location.href='/tour/update/{{ packagetour.pk }}/'">수정</button>
							{% endif %}
						</h2>
					</div>
					<!--패키지 여행 설명-->
					<div class="col-md-6 animate-box">
						<div class="row">
							{{ packagetour.get_content_markdown | safe }}
						</div>
					</div>
					<!--패키지 여행 이미지-->
					<div class="col-md-6 animate-box">
						<img class="img-responsive" src="{{ packagetour.image.url }}" alt="travel">
					</div>
				</div>
			</div>
	</div>

		<!--댓글-->
		<div id="fh5co-testimonial">
			<div class="container">

				<h1 style="color:white;">Comment</h1>

				<div class="row">
					<!--댓글 작성 부분 로그인 한 유저에게만 보이기-->
					{% if user.is_authenticated %}
						<!--댓글 작성 시 상세 페이지로 다시 이동-->
						<form class="mb-4" id="comment_form" method="POST" action="{{ packagetour.get_absolute_url }}new_comment/">
							{% csrf_token %}
							<!--댓글 창-->
							<div class="form-group">{{ comment_form | crispy }}</div>
							<!--댓글 Summit 버튼-->
							<div class="col-auto">
								<button type="submit" class="btn btn-primary mb-3">댓글 달기</button>
							</div>
						</form>
					{% else %}
						<!--클릭 시 로그인 모달 창 보이기-->
						<h2>
							로그인 후 댓글 작성하실 수 있습니다.
							<a href="#" role="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#loginModal">로그인하기</a>
						</h2>
					{% endif %}
					<br/>
					<br/>
				</div>

				<div class="row">
					<!-- 댓글 있으면 출력-->
					{% if packagetour.comment_set.exists %}
						{% for comment in packagetour.comment_set.all %}
							<div class="col-lg-12 col-md-12 col-sm-12">
								<div class="box-testimony animate-box">
									<blockquote>
										<!--사용자 아바타-->
										<img class="quote" src="{{ comment.get_avatar_url }}" alt="{{ comment.author }}'s avatar" width="60px"/>
										<!--댓글 내용-->
										<p>&ldquo;{{ comment.content }}&rdquo;</p>
									</blockquote>
									<!--작성자 + 작성 시작-->
									<p class="author">{{ comment.author.username }}<span class="subtext">{{ comment.created_at }}</span></p>
								</div>
							</div>
						{% endfor %}
					{% endif %}
				</div>
			</div>
		</div>

{% endblock %}
